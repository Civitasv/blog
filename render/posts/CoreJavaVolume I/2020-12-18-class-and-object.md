---
title: "对象与类"
summary: "面向对象程序设计，object-oriented programming，简称 OOP。是当今主流的程序设计泛型，取代了 20 世纪 70 年代的“结构化”或过程式编程技术（典型的如`C`）"
date: "2020-12-18"
author: "Civitasv"
categories:
  - CoreJAVAVolume I
tags:
  - Java核心技术卷I
---

## 面向对象程序设计概述

面向对象程序设计，object-oriented programming，简称 OOP。是当今主流的程序设计泛型，取代了 20 世纪 70 年代的“结构化”或过程式编程技术（典型的如`C`）。

传统结构化程序设计思路：

1. 确定求解问题的过程；

2. 选择存储数据的适当方式。

`Pascal`语言设计者`Niklaus Wirth`:

`Programs = Algorithms + Data Structures`

而在面向对象程序设计中，我们会首先确定存储数据的适当方式，也就是设计好我们的类、接口等数据结构，然后再考虑求解问题的算法。

### 类`class`

类是构造对象的模板或蓝图。由类构造（`construct`）对象过程称为创建类的实例（`instance`）。

### 对象

对象的三个主要特性：

1. 行为（behavior）：可以对对象完成哪些操作，应用哪些方法

2. 状态（state）：调用方法时，对象会如何响应

3. 标识（identity）：如何区分不同对象

### 类之间的关系

- 依赖 `uses-a`

  如果一个类的方法需要使用或操纵另一个类的对象，我们就说一个类依赖于另一个类

- 聚合 `has-a`

  一个类包含另一个类的对象，称为聚合

- 继承 `is-a`

### 对象与对象变量

对象变量是对对象的**引用**，而不是对象。

代码`Date deadline`定义`dealine`对象变量，但此时还不能使用，因为还未引用到任何对象。

## 封装的优点

我们常常会将类中的字段设置为`private`，然后为其提供**访问器方法**和**更改器方法**。

新手常常可能疑惑为什么不直接定义字段为`public`呢？主要有以下几点考虑：

1. 如果将字段定义为`public`，那么我们就有责任一直维护这个字段，这个字段的名字将不能被改变，因为如果改变了，使用该 API 的用户的程序将会报错，这是不可接受的，定义为`private`将没有这个隐患，我们只需要负责维护访问器方法和更改器方法，而具体内部是怎么实现的，字段的名称是什么，用户都不需要关心；

2. 更改器方法（set）可以提供错误检查，例如某些字段有范围限制。

注意：对于更改器方法，不能返回一个可变对象的引用，如`Date`对象，如果实在需要，可以返回它的克隆对象。

## 方法参数

一般来说，将参数传递给方法有两种方式：

- 按值调用（call by value）：表示方法接收的是调用者提供的值

- 按引用调用（call by reference）：表示方法接收的是调用者提供的变量地址

Java 语言初学者往往认为 Java 像 C++一样，既具有按值调用（基本类型）又具有按引用调用（引用类型），实际上，Java 程序设计语言总是 **按值调用**。也就是方法无法修改传递给它的任何参数变量的内容。

如：

```java
public static void raisePercent(double x){
    x *=3;
}
double percent = 10;
raisePercent(percent);
```

无论这个方法怎么实现，执行完毕后，percent 值永远还是 10。

执行流程为：

1. x 初始化为 percent 的一个副本；
2. x\*=3，但 percent 不变；
3. 方法结束后，x 变量不再使用。

如果传递的是对象引用呢？

```java
public static void raisePercent(Employee x){
    x.raisePercent(200);
}
Employee harry = new Employee(...);
raisePercent(harry);
```

这里`harry`的`percent`值将提高 200%。

执行流程为：

1. 对象变量 x 初始化为对象变量 harry 的一个副本，是一个对象引用，与 harry 指向（引用）同一个对象；

2. 对象变量 x 和对象变量 harry 指向的同一个对象工资提高 200%；

3. 方法结束后，对象变量 x 不再使用。

有些初学者错误的认为这属于按引用传递方式，这种思维还很普遍，提供以下测试：

```java
public void swap(Employee x, Employee y){
    Employee temp = x;
    x = y;
    y = temp;
}
```

如果 Java 是按引用传递，那么 swap 函数将会交换 x 和 y，但实际上执行之后并不会改变，因为 x 和 y 对象变量将会被初始化为传递的两个对象变量的副本，两个副本交换并没有意义。

因此，Java 是纯按值传递的程序设计语言。

总结一下：

1. 方法不能修改基本数据类型的参数；

2. 方法可以改变对象变量参数的状态（state）；

3. 方法不能让一个对象变量参数引用一个新的对象。（C++可以）
